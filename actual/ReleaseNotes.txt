23.02.2016
Version 1.1.18.12: Изменил процедуру построения 
графиков нагрузки на БС. Убрал жесткую привязку 
к мас-адресам и цвету.Теперь берется из базы.

Version 1.1.18.13: В процедуре построения графиков 
нагрузки на БС изменил отображение ProgressBar

Version 1.1.18.14: Для кнопок включения и 
отключения wifi увеличил интервал ожидания 
перезагрузки устройства

Version 1.1.18.15: Добавил проверку на boot_mode 
ptx 
при подключении через OMStip

27.04.2016
Version 1.1.18.16: Переназначил процедуру, 
отображающую скрытую кнопку для 
"закрашивания" 
статистики на lbl_more_78

30.04.2016
Version 1.1.18.17: Добавил интерфейс VISTJ1939 для 
OMSsniff. Добавил недостающие интерфейсы в 
ReloadDrivers.

10.05.2016
Version 1.1.18.18: Добавил задежку в expect - без 
нее 
не  заходил во 2-ой GSP (connect Can.129) если 
изначально находились в первом GSP (if 
{$flag=="GSP"}) 

12.05.2016
Version 1.1.18.19: Изменил процедуру обновления 
mac-адреса bullet и добавил обновление firmware 
bullet

18.05.2016
Version 1.1.18.20: Исправил отрисовку пропадания 
сигнала -100: иногда рисовало -256 (было: if 
Query.Fields[2].AsInteger=156, стало if Query.Fields
[2].AsInteger=156)

03.06.2016
Version 1.1.18.21: Добавил Совмещенный график 
Gps и wifi

09.06.2016
Version 1.1.18.22: Убран пункт popup-меню 
"Информация по весам VEI (VEI_DUMP)" (VEI 
заменен на VIST на всех машинах).
Добавлены пункты: "Журнал транзакций (ночная 
смена)", "Журнал транзакций (дневная смена)" и 
"Журнал транзакций (текущая смена) - мониторинг"
Изменил путь для проверки автообновлений с '\
\10.70.0.62\diskw\УКиСС\Участок АСУ ГТК
\programs\ubiquiti_stats\ubnt_stats' 
на 'w:\УКиСС\Участок АСУ ГТК\programs
\ubiquiti_stats\ubnt_stats'

09.06.2016
Version 1.1.18.23: по просьбе трудящихся перенес
(скопировал) пункт меню "перезагрузка драйверов" 
повыше

22.06.2016
Version 1.1.18.24: OMSSniff-omnicomm выбирал всЁ 
вместе с request. Теперь выбирает только VS-DATA

17.10.2016
Version 1.1.18.25: Исправил вывод подсказок на 
графике - неверно выводилось имя БС. Не учитывал 
2 начальные точки, которые 
рисуются для масштабирования графика. 
Подсказка выводилась смещенная на 2 этих точки.
Исправил вывод координат выбранной точки на 
карте карьера. Выводилась смещенная на 2 точки. 
Увеличил размер окна анализа связи в квадрате, 
чтобы не было полосы прокрутки.

09.11.2016
Version 1.1.18.26:
Статистика по БС пишется в таблицу stats_ap, 
исправлено построение графика доступности.
добавлен просмотр статистики по БС: загрузка 
процессора, свободная память, rx_octets_eth_0, 
tx_octets_eth0
Version 1.1.18.27: исправление бага, допущенного в 
Version 1.1.18.26 (раскрашивал желтым точки -100 
при статусе не_готов, а надо серым).

10.11.2016
Version 1.1.18.28:
-изменил названия пунктов меню (rx_octets_eth0 -> 
Скорость приема по eth0 [bit/sec],  (tx_octets_eth0 -> 
Скорость передачи по eth0 [bit/sec])
-не рисую на графиках свободной памяти и скорости 
приема и передачи нулевые значения и -1 для 
loadavg
Version 1.1.18.29:
-изменил названия пунктов меню ([bit/sec] -> 
[байт/сек])

12.03.2017
Version 1.1.18.31:
-Исключил А106 из построения отчета по потеряным 
пакетам за ночную смену. Нужно будет после 
монтажа включить, а А107 исключить.

15.03.2017
Version 1.1.18.32:
-Исключил А107 и добавил А138 из/в построение 
отчета по потеряным пакетам за ночную смену.

16.03.2017
Version 1.1.18.33:
-Переделал ReloadDrivers - наполнение списков 
ИмяАвто и MassIP сделал из БД 
(SELECT eq.name as nm, p.ip_address as ip FROM 
`equipment` eq, modems m, ptx p WHERE 
eq.equipment_type=1 and eq.name = m.name and 
m.id_modem = p.id_modem order by nm)

24.03.2017
Version 1.1.18.34:
-исправил вывод неправильной позиции на карте по 
щелчку на графике gps-координат.

27.03.2017
Version 1.1.18.35:
-Добавил поле place_install_new в таблицу ptx_history. 
Соответственно изменил код.

28.03.2017
Version 1.1.18.36:
-В потеряных пакетах по всем авто значения "0" не 
выводятся - заменяются пустотой.


27.04.2017
Version 1.1.18.37:
-добавил А140 в построение отчета по потеряным 
пакетам за ночную смену.(стоял фильтр в выборке: 
and (id_modem<>10))

11.08.2017
Version 1.1.18.38:
-изменил путь для FTPFileZilla на Program files (x86) в 
связи с переходом на Win7

12.08.2017
Version 1.1.18.39, 1.1.18.40:
-изменил путь для Putty на Program files (x86) в связи 
с переходом на Win7

13.08.2018
Version 1.1.18.41, Version 1.1.18.42
-Изменил структуру таблицы modems 
ALTER TABLE `modems` ADD `is_ap_repeater` TINYINT 
UNSIGNED NOT NULL DEFAULT '0' AFTER 
`id_equipment`, ADD `mac_wds_peer` VARCHAR(50) 
NULL DEFAULT NULL AFTER `is_ap_repeater`;
-переделал процедуру для построения графика 
уровня сигнала  
-кнопка UNION для построения графика уровня 
сигнала из 2 таблиц (для AP-репитер или АР 
которые 
были клиентами строим union запрос из 2 таблиц). 

14.08.2018
Version 1.1.18.43
-Изменил блокировку построения графиков для БС 
при выборе не БС на более мягкую, чтобы можно 
было построить графики для ap-repeater
-Изменил построение зоны покрытия БС - теперь 
строит и для AP-репитера.

12.09.2018
Version 1.1.18.44
-Пришел из ремонта булит с новой ревизией 
железа, 
который не даунгрейдится на версию 5.5.6. Для 
этой 
версии мак-адрес булита возвращается по snmp в 
виде кодированной 6-и байтовой строки, 
 сделал преобразование в нормальное 
представление (цикл по строке и в цикле Result := 
Result + Ord(AStr[i]))
 
30.10.2018
Version 1.1.18.45
- изменил форму перезагрузки драйверов, сделал 
выпадающий список по всему оборудованию (было 
только по авто), т.к. подключили vims на EX450

14.11.2018
Version 1.1.18.46
- изменил строку-фильтр при выполнении просмотра 
сниффов, добавил :. Было: EX1 стало EX1: 

06.05.2019
Version 1.1.21.47
- исправил процедуру перезагрузки РТХ из 
выпадающего меню. Ошибка была в типе данных 
AnsiString. Заменил на String.

27.06.2019
Version 1.1.21.48
добавил на главную форму и форму карты 
компонент TFormStorage для сохранения положения 
и размеров окна. Это связано с некорректным 
отображением форм на компьютере с двумя 
мониторами.

12.12.2019
Version 1.1.21.49
Разнёс экскаваторы, авто, бурстанки и базовые 
станции по отдельным вкладкам
Version 1.1.21.50
Исправил equipment_type для бурстанков - поставил 
5 вместо 4 (4 - это сервера)

20.12.2019
Version 1.1.21.51
Увеличил шрифт, добавил картинки на вкладки, 
сделал динамическое меню и динамический пункт 
"пинговать РТХ и Bullet"

Version 1.1.21.52
для бурстанков добавил пункты меню 
"Подключиться к Кобусу", "Подключиться к 
BulletAP", "Подключиться к коммутатору"

24.01.2020
Version 1.1.21.53
перевёл байт/сек в Кбит/сек при построении 
графиков 

27.01.2020
Version 1.1.21.54
Отобразил пункт построить по БС для авто, т.к. 
добавил возможность собирать статистику по 
булетам как для БС(загрузка процессора, 
свободная память, скорость приема/передачи).
Добавил пункт Подключиться к Кобусу по SSH

28.01.2020
Version 1.1.21.55
Добавил пункт меню Подключиться к Bullet по SSH

01.02.2020
Version 1.1.21.56
Добавил checkBox AP-репитер и comboBox для 
mac_wds_peer. В сборе статистики флаг 
is_ap_repeater перечитывается из базы  1 раз в 5 
минут.

13.02.2020
Version 1.1.21.57
Сделал прокрутку в форме карты и чтобы 
неопределенные статусы окрашивались белым

14.02.2020
Version 1.1.21.58
Убрал проверку для BulletAP BVU103, т.к. его 
смонтировали.

21.02.2020
Version 1.1.21.59
Исправил построение графиков нагрузки БС 
(SMOTR_2 строился жирными точками), добавил 
сюда же построение графика для репитера.

26.02.2020
Version 1.1.21.60
Исправил ошибку - не очищался старый график GPS 
при построении совмещённого графика

Version 1.1.21.61
Исправил ошибку - переместил ini файл в каталог 
приложения

27.02.2020
Version 1.1.21.62
Сменился пароль на пользователя lgktech. Заменил.

03.03.2020
Version 1.1.21.63
В форме MapFail использовался ini-файл из 
директории Windows. Переместил ini файл в каталог 
приложения. Добавил вкладку ReleaseNotes.

17.03.2020
Version 1.1.21.64
Форме ReloadDriver установил свойство position в 
poMainFormCenter
Version 1.1.21.65
Добавил дополнительную проверку filezilla по пути 
C:\Program Files\

27.03.2020
Version 1.1.21.66
Добавил кнопку для отчета по wifi по бурстанкам за 
месяц (делал Сорокину).
Форме frmChangePTX установил свойство position в 
poMainFormCenter

28.03.2020
Version 1.1.21.67
Немножко переделал отчет по wifi по бурстанкам и 
перенес кнопку чуть выше.
Теперь начальная и конечная даты для отчета 
задаются датами "с" и "по" ниже календаря

31.03.2020
Version 1.1.21.68
Изменился equipment_type с 5 на 6 для СЗМ-ок и они 
перестали отображаться на вкладке с бурстанками. 
Исправил.

14.04.2020
Version 1.1.21.69
-Переделал выбор агрегированных параметров по 
технике в статусе ГОТОВ (Button7)
-Сделал связь между таблицами modems - equipment 
через поле id_equipment (раньше было по имени)
-Сделал пункт меню "Перезагрузить КОБУС"
-Добавил поле 'ip_pc' в таблицу equipment. 
Переделал так, чтобы ip-адрес PTX брался из этого 
поля.

17.04.2020
Version 1.1.21.70
Добавил пункт в меню просмотра снифов -  
просмотр данных по PressureProJ1939

22.06.2020
Version 1.1.21.71
В модуле ReloadDrivers изменил запрос списка авто 
и экскаваторов для возможности проверки 
драйверов при снятом РТХ.
Запрос теперь делаю из таблицы equipment без 
привязки к другим таблицам.

03.07.2020
Version 1.1.21.72
Убрал обновление mac-адреса bullet-а в БД при 
выборе соответствующего пункта в меню. 
Обновляется только firmware.

12.07.2020
Version 1.1.21.73
Переделал запуск ping-ов c ShellExecute на 
CreateProcess для управления размером и 
положением запускаемых окон
Version 1.1.21.74
Изменил запуск пингов - добавил изменение 
заголовка окна на имя устройства

14.07.2020
Version 1.1.21.75
Добавил настройку на вкладку 2 - "Маленькие окна 
ping-a". Настройка сохраняется через formStorage.

15.07.2020
Version 1.1.21.76
Сделал автоматическую расстановку окон пинга 
сеткой в зависимости от расширения экрана. 
Размеры окна пинга заданы в константах, при 
желании можно вынести в настройки или поменять 
константы. 
Version 1.1.21.77
Некорректно определялись закрытые процессы 
пингов. Исправил.
Version 1.1.21.78
Забыл исправить  в цикле downto на to, из-за этого 
в процессе проверки пустого массива пинг не 
запускался из-за access violation - исправил.
Version 1.1.21.79
Вынес настройки размера окна пинга в закладку log 
and setup.

19.07.2020
Version 1.1.21.80
Добавил возможность задавать размеры окна 
ping-ов в символах. 
При этом используется команда mode con:cols=[int] 
lines=[int] из cmd.exe 
Это сделано для Windows 10, так как установка 
размеров окна из CreateProcess в Win10 не 
работает. Единственный минус этого способа - 
пропадает вертикальная полоса прокрутки.

22.07.2020
Version 1.1.21.81
Сделал картинки с прозрачным фоном на закладках 
с помощью компонента TsAlphaImageList (из набора 
компонентов AlphaControls). В нём можно добавлять 
png с прозрачным фоном.

04.12.2020
Version 1.1.21.82
Поправил легенду на графике. Добавил 2 пункта в 
меню: 
Подключиться к Bullet (взрывцех) и
Подключиться к Bullet по SSH (взрывцех) 
При выборе этих пунктов  подключается по ip_alias 
(новое поле в таблице equipment)

04.12.2020
Version 1.1.21.83
Если график строится не за период а за текущие 
сутки, то линию -78 рисуем от 0:00 до текущего 
времени.

05.12.2020
Version 1.1.21.84
Линию -78 рисуем даже в том случае, если 
статистика по устройству не собирается.
(от 0:00 до текущего 
времени).

07.12.2020
Version 1.1.21.85
Исправил: при выборе предыдущих дат в календаре 
линия -78 рисовалась от текущей полночи до 
текущего времени.

Version 1.1.21.86
Исправление ошибок в построении линии -78

28.12.2020
Version 1.1.21.87
Исправлено: при отображении выпадающего меню 
для бурстанков отображались пункты меню 
Подключиться к Bullet (взрывцех) и Подключиться к 
Bullet по SSH (взрывцех)

Version 1.1.21.88
Исправил косячок версии  1.1.21.87: скрывались 
для всех и не отображались

31.03.2021
Version 1.1.21.89
Сделал обновление таблицы TableLog после 
перезагрузки РТХ и записи в лог.

01.04.2021
Version 1.1.21.90
Удалил лишние столбцы из таблицы, добавил 
столбец IP Alias.
Добавил функционал применения MAC ACL. 
Удалил лишние кнопки.

04.05.2021
Добавил Disable_MAC_ACL
В планах добавление функций добавления/замены 
для булитов.

19.07.2021
Version 1.1.21.91
Раскомментировал блокировку построения графика 
GPS для бурстанков
Сделал обработку исключения, которое 
выскакивало при отсутствии GPS-координат
Version 1.1.21.92
Изменил код для устранения деления на 0 

04.08.2021
Version 1.1.21.93
Добавил построение графиков уровня сигналов LTE

05.08.2021
Version 1.1.21.94
"Навёл красоту" для графиков LTE: убрал & в 
заголовке графика и изменил цвета

16.08.2021
Version 1.1.21.95
Добавил построение графика ping.
Добавил столбцы для LTE-модемов в таблицу и 
убрал лишние неинформативные поля.
Добавил пингование ip_lte и ip_vpn LTE-модема если 
он есть.
Добавил сохранение высоты графика.

16.08.2021
Version 1.1.21.96
Добавил переменную для отображения правильной 
единицы измерения в подсказке графика. 

23.08.2021
Version 1.1.21.97
Изменено: в заголовках окон ping-ов пишется имя 
оборудования (раньше было имя модема)

24.08.2021
Version 1.1.21.98
Изменено: вместо поля modems.name везде 
использую поле equipment.name

25.08.2021
Version 1.1.21.99
Сделал подсветку всей строки таблицы при 
выделении.
Сделал обновление таблицы базовых станций в 
соответствии с полем online (в сборе статистики 
добавил обновление этого поля)

06.09.2021
Version 1.1.22.00
Для графика Ping отключил автомасштабирование по оси Y
Version 1.1.22.1
Изменил цвет и размер точки для графика ping

18.09.2021
Version 1.1.22.2
Переделал построение графика уровня сигнала на использование поля id_equipment вместо id_modem
Исправил неработающие подсказки на графике пингов
Переделал построение графиков на использование поля datetime.
Оптимизация кода: сократил повторяющийся код, вынес его в функцию GetSQLWhereDateTime(FieldName)
Добавил параметр FieldName в GetSQLWhereDateTime и изменил условия > < на BETWEEN.
Переделал отрисовку статусов по таблице stats_status вместо поля status. 
Статусы теперь учитываются во всех графиках сигналов (ping, lte, wifi).

20.09.2021
Version 1.1.22.3
Для бурстанков и сзм в таблице stats_status  есть только простои. 
Исправил поиск статуса при построении графика для них с учётом этого.

07.10.2021
Version 1.1.22.4
Исправил построение графика 'Нагрузка БС' и 
график уровня сигнала всех клиентов по базовой 
станции

Version 1.1.22.5
Добавил 2 скытых кнопки для управления MAC ACL репитеров

Version 1.1.22.6
Удалил одну скрытую кнопку для "закрашивания" потеряных пакетов (она перестала работать после введения таблицы stats_status).
Исправил запрос для выбора из stats_status - последний статус за сутки не обрабатывался.

26.10.2021
Version 1.1.22.7
Добавил галочку Access Point для экскаваторов, когда на экскаваторе с LTE включаем булет в качестве точки доступа. Сбор статистики тоже доработал под это.

Version 1.1.22.8
Не снималась галочка AP_Repeater у экскаваторов, которые Access point. Исправил условие проверки.

27.10.2021
Version 1.1.22.9
Исправил построение графика для мобильных 
объектов в режиме Access point
Исправил ошибку, возникающую при правом клике на графике ping

17.11.2021
Version 1.1.23.0
Переделал запросы для отображения таблиц 
(раньше главная таблица была modems, теперь - equipment)
Сделал кнопки для снятия/замены/установки bullet и такой же функционал  для LTE-модемов
Добавил ещё 2 таблицы в БД: lte_history и bullet_history.
В таблице lte переименовал поле id в поле id_lte
В таблице ptx_history вместо 2 полей date и time сделал одно: datetime

18.11.2021
Version 1.1.23.1
После изменения полей в Query не заменил 
modemsname_2 на modemsname. Исправил.

23.11.2021
Version 1.1.23.2
Исправил ошибку, возникающую при нажатии кнопок Снять РТХ и Снять Bullet

25.11.2021
Version 1.1.23.3
Исправил ошибку: при снятии булита с техники 
пропадает также и РТХ. 
Исправил неверный sql-запрос для экскаваторов.
